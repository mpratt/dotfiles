#!/bin/bash
##################################################################
#  Script que actualiza tags de un Proyecto en PHP
#  Michael Pratt <pratt@hablarmierda.net>
##################################################################
[ "$#" -lt 1 ] && echo "$(basename $0) <output> <path>" && exit 0
[ -z "${2}" ] && PLACE="${PWD}" || PLACE="${2}"
OUTPUT="${1}"

cd "${PLACE}"

ctags -f "${OUTPUT}" \
-h ".php" -R \
--exclude="\.svn" \
--exclude="\.git" \
--exclude="*.js" \
--exclude="tests/*" \
--exclude="vendor/*" \
--exclude="Vendor/*" \
--exclude="Assets/*" \
--exclude="assets/*" \
--exclude="composer.phar" \
--exclude="Composer.phar" \
--exclude="Tests/*" \
--totals=yes \
--tag-relative=yes \
--PHP-kinds=+ivcf \
--regex-PHP='/(abstract)?\s+class\s+([^ ]+)/\2/c/' \
--regex-PHP='/(static|abstract|public|protected|private)\s+function\s+(\&\s+)?([^ (]+)/\3/f/' \
--regex-PHP='/interface\s+([^ ]+)/\1/i/' \
--regex-PHP='/\$([a-zA-Z_][a-zA-Z0-9_]*)/\1/v/'
